#include <systemc.h>
#include <tlm.h>
#include "sched_MPEG4_algo_IS.h"

#ifdef __cplusplus
extern "C" {
#endif
/* Generated by CIL v. 1.3.6 */
/* print_CIL_Input is false */

struct MPEG4_algo_IS_variables {
   int BUF_SIZE ;
   int addr ;
   int Scanmode[192] ;
   int add_buf ;
   int half ;
   int count ;
   int buf[128] ;
};
void libcal_printf(char const   *format  , ...) ;
// To enable traces, change 1 by 0 in the #if below
#if 1
#define libcal_printf //
#endif
int currentSystemTime(void) ;
int openFile(char *file_name ) ;
void picture_displayImage(void) ;
void picture_setPixel(int x , int y , int r , int g , int b ) ;
int readByte(int fd ) ;
int JFrame(char *title ) ;
int Picture(int width , int height ) ;
void MPEG4_algo_IS_done(struct MPEG4_algo_IS_variables *_actor_variables ) ;
int MPEG4_algo_IS_function_ra(struct MPEG4_algo_IS_variables *_actor_variables , int addr ) ;
int MPEG4_algo_IS_function_wa(struct MPEG4_algo_IS_variables *_actor_variables ) ;
void MPEG4_algo_IS_read_only(struct MPEG4_algo_IS_variables *_actor_variables , int ac ) ;
void MPEG4_algo_IS_read_write(struct MPEG4_algo_IS_variables *_actor_variables , int ac ,
                              int *PQF_AC ) ;
void MPEG4_algo_IS_skip(struct MPEG4_algo_IS_variables *_actor_variables , int i ) ;
void MPEG4_algo_IS_start(struct MPEG4_algo_IS_variables *_actor_variables , int i ) ;
void MPEG4_algo_IS_write_only(struct MPEG4_algo_IS_variables *_actor_variables , int *PQF_AC ) ;

#ifdef __cplusplus
}
#endif

void sched_MPEG4_algo_IS::process() {
/* Generated by CIL v. 1.3.6 */
/* print_CIL_Input is false */

 
{ int fsm_state ;
  int _token_1 ;
  int _out_1 ;
  int _token_2 ;
  int _token_3 ;
  int _token_4 ;
  int _token_5 ;
  int _token_6 ;
  int _out_2 ;
  int _call_11 ;
  int _call_12 ;
  int _call_13 ;
  int _call_14 ;
  int _call_15 ;
  int _call_16 ;
  struct MPEG4_algo_IS_variables *_actor_variables ;
  int k ;

  {
  _actor_variables = (struct MPEG4_algo_IS_variables *)malloc(1300);
  _actor_variables->BUF_SIZE = 128;
  _actor_variables->Scanmode[0 + 0] = 0;
  _actor_variables->Scanmode[0 + 1] = 1;
  _actor_variables->Scanmode[0 + 2] = 5;
  _actor_variables->Scanmode[0 + 3] = 6;
  _actor_variables->Scanmode[0 + 4] = 14;
  _actor_variables->Scanmode[0 + 5] = 15;
  _actor_variables->Scanmode[0 + 6] = 27;
  _actor_variables->Scanmode[0 + 7] = 28;
  _actor_variables->Scanmode[0 + 8] = 2;
  _actor_variables->Scanmode[0 + 9] = 4;
  _actor_variables->Scanmode[0 + 10] = 7;
  _actor_variables->Scanmode[0 + 11] = 13;
  _actor_variables->Scanmode[0 + 12] = 16;
  _actor_variables->Scanmode[0 + 13] = 26;
  _actor_variables->Scanmode[0 + 14] = 29;
  _actor_variables->Scanmode[0 + 15] = 42;
  _actor_variables->Scanmode[0 + 16] = 3;
  _actor_variables->Scanmode[0 + 17] = 8;
  _actor_variables->Scanmode[0 + 18] = 12;
  _actor_variables->Scanmode[0 + 19] = 17;
  _actor_variables->Scanmode[0 + 20] = 25;
  _actor_variables->Scanmode[0 + 21] = 30;
  _actor_variables->Scanmode[0 + 22] = 41;
  _actor_variables->Scanmode[0 + 23] = 43;
  _actor_variables->Scanmode[0 + 24] = 9;
  _actor_variables->Scanmode[0 + 25] = 11;
  _actor_variables->Scanmode[0 + 26] = 18;
  _actor_variables->Scanmode[0 + 27] = 24;
  _actor_variables->Scanmode[0 + 28] = 31;
  _actor_variables->Scanmode[0 + 29] = 40;
  _actor_variables->Scanmode[0 + 30] = 44;
  _actor_variables->Scanmode[0 + 31] = 53;
  _actor_variables->Scanmode[0 + 32] = 10;
  _actor_variables->Scanmode[0 + 33] = 19;
  _actor_variables->Scanmode[0 + 34] = 23;
  _actor_variables->Scanmode[0 + 35] = 32;
  _actor_variables->Scanmode[0 + 36] = 39;
  _actor_variables->Scanmode[0 + 37] = 45;
  _actor_variables->Scanmode[0 + 38] = 52;
  _actor_variables->Scanmode[0 + 39] = 54;
  _actor_variables->Scanmode[0 + 40] = 20;
  _actor_variables->Scanmode[0 + 41] = 22;
  _actor_variables->Scanmode[0 + 42] = 33;
  _actor_variables->Scanmode[0 + 43] = 38;
  _actor_variables->Scanmode[0 + 44] = 46;
  _actor_variables->Scanmode[0 + 45] = 51;
  _actor_variables->Scanmode[0 + 46] = 55;
  _actor_variables->Scanmode[0 + 47] = 60;
  _actor_variables->Scanmode[0 + 48] = 21;
  _actor_variables->Scanmode[0 + 49] = 34;
  _actor_variables->Scanmode[0 + 50] = 37;
  _actor_variables->Scanmode[0 + 51] = 47;
  _actor_variables->Scanmode[0 + 52] = 50;
  _actor_variables->Scanmode[0 + 53] = 56;
  _actor_variables->Scanmode[0 + 54] = 59;
  _actor_variables->Scanmode[0 + 55] = 61;
  _actor_variables->Scanmode[0 + 56] = 35;
  _actor_variables->Scanmode[0 + 57] = 36;
  _actor_variables->Scanmode[0 + 58] = 48;
  _actor_variables->Scanmode[0 + 59] = 49;
  _actor_variables->Scanmode[0 + 60] = 57;
  _actor_variables->Scanmode[0 + 61] = 58;
  _actor_variables->Scanmode[0 + 62] = 62;
  _actor_variables->Scanmode[0 + 63] = 63;
  _actor_variables->Scanmode[0 + 64] = 0;
  _actor_variables->Scanmode[0 + 65] = 4;
  _actor_variables->Scanmode[0 + 66] = 6;
  _actor_variables->Scanmode[0 + 67] = 20;
  _actor_variables->Scanmode[0 + 68] = 22;
  _actor_variables->Scanmode[0 + 69] = 36;
  _actor_variables->Scanmode[0 + 70] = 38;
  _actor_variables->Scanmode[0 + 71] = 52;
  _actor_variables->Scanmode[0 + 72] = 1;
  _actor_variables->Scanmode[0 + 73] = 5;
  _actor_variables->Scanmode[0 + 74] = 7;
  _actor_variables->Scanmode[0 + 75] = 21;
  _actor_variables->Scanmode[0 + 76] = 23;
  _actor_variables->Scanmode[0 + 77] = 37;
  _actor_variables->Scanmode[0 + 78] = 39;
  _actor_variables->Scanmode[0 + 79] = 53;
  _actor_variables->Scanmode[0 + 80] = 2;
  _actor_variables->Scanmode[0 + 81] = 8;
  _actor_variables->Scanmode[0 + 82] = 19;
  _actor_variables->Scanmode[0 + 83] = 24;
  _actor_variables->Scanmode[0 + 84] = 34;
  _actor_variables->Scanmode[0 + 85] = 40;
  _actor_variables->Scanmode[0 + 86] = 50;
  _actor_variables->Scanmode[0 + 87] = 54;
  _actor_variables->Scanmode[0 + 88] = 3;
  _actor_variables->Scanmode[0 + 89] = 9;
  _actor_variables->Scanmode[0 + 90] = 18;
  _actor_variables->Scanmode[0 + 91] = 25;
  _actor_variables->Scanmode[0 + 92] = 35;
  _actor_variables->Scanmode[0 + 93] = 41;
  _actor_variables->Scanmode[0 + 94] = 51;
  _actor_variables->Scanmode[0 + 95] = 55;
  _actor_variables->Scanmode[0 + 96] = 10;
  _actor_variables->Scanmode[0 + 97] = 17;
  _actor_variables->Scanmode[0 + 98] = 26;
  _actor_variables->Scanmode[0 + 99] = 30;
  _actor_variables->Scanmode[0 + 100] = 42;
  _actor_variables->Scanmode[0 + 101] = 46;
  _actor_variables->Scanmode[0 + 102] = 56;
  _actor_variables->Scanmode[0 + 103] = 60;
  _actor_variables->Scanmode[0 + 104] = 11;
  _actor_variables->Scanmode[0 + 105] = 16;
  _actor_variables->Scanmode[0 + 106] = 27;
  _actor_variables->Scanmode[0 + 107] = 31;
  _actor_variables->Scanmode[0 + 108] = 43;
  _actor_variables->Scanmode[0 + 109] = 47;
  _actor_variables->Scanmode[0 + 110] = 57;
  _actor_variables->Scanmode[0 + 111] = 61;
  _actor_variables->Scanmode[0 + 112] = 12;
  _actor_variables->Scanmode[0 + 113] = 15;
  _actor_variables->Scanmode[0 + 114] = 28;
  _actor_variables->Scanmode[0 + 115] = 32;
  _actor_variables->Scanmode[0 + 116] = 44;
  _actor_variables->Scanmode[0 + 117] = 48;
  _actor_variables->Scanmode[0 + 118] = 58;
  _actor_variables->Scanmode[0 + 119] = 62;
  _actor_variables->Scanmode[0 + 120] = 13;
  _actor_variables->Scanmode[0 + 121] = 14;
  _actor_variables->Scanmode[0 + 122] = 29;
  _actor_variables->Scanmode[0 + 123] = 33;
  _actor_variables->Scanmode[0 + 124] = 45;
  _actor_variables->Scanmode[0 + 125] = 49;
  _actor_variables->Scanmode[0 + 126] = 59;
  _actor_variables->Scanmode[0 + 127] = 63;
  _actor_variables->Scanmode[0 + 128] = 0;
  _actor_variables->Scanmode[0 + 129] = 1;
  _actor_variables->Scanmode[0 + 130] = 2;
  _actor_variables->Scanmode[0 + 131] = 3;
  _actor_variables->Scanmode[0 + 132] = 10;
  _actor_variables->Scanmode[0 + 133] = 11;
  _actor_variables->Scanmode[0 + 134] = 12;
  _actor_variables->Scanmode[0 + 135] = 13;
  _actor_variables->Scanmode[0 + 136] = 4;
  _actor_variables->Scanmode[0 + 137] = 5;
  _actor_variables->Scanmode[0 + 138] = 8;
  _actor_variables->Scanmode[0 + 139] = 9;
  _actor_variables->Scanmode[0 + 140] = 17;
  _actor_variables->Scanmode[0 + 141] = 16;
  _actor_variables->Scanmode[0 + 142] = 15;
  _actor_variables->Scanmode[0 + 143] = 14;
  _actor_variables->Scanmode[0 + 144] = 6;
  _actor_variables->Scanmode[0 + 145] = 7;
  _actor_variables->Scanmode[0 + 146] = 19;
  _actor_variables->Scanmode[0 + 147] = 18;
  _actor_variables->Scanmode[0 + 148] = 26;
  _actor_variables->Scanmode[0 + 149] = 27;
  _actor_variables->Scanmode[0 + 150] = 28;
  _actor_variables->Scanmode[0 + 151] = 29;
  _actor_variables->Scanmode[0 + 152] = 20;
  _actor_variables->Scanmode[0 + 153] = 21;
  _actor_variables->Scanmode[0 + 154] = 24;
  _actor_variables->Scanmode[0 + 155] = 25;
  _actor_variables->Scanmode[0 + 156] = 30;
  _actor_variables->Scanmode[0 + 157] = 31;
  _actor_variables->Scanmode[0 + 158] = 32;
  _actor_variables->Scanmode[0 + 159] = 33;
  _actor_variables->Scanmode[0 + 160] = 22;
  _actor_variables->Scanmode[0 + 161] = 23;
  _actor_variables->Scanmode[0 + 162] = 34;
  _actor_variables->Scanmode[0 + 163] = 35;
  _actor_variables->Scanmode[0 + 164] = 42;
  _actor_variables->Scanmode[0 + 165] = 43;
  _actor_variables->Scanmode[0 + 166] = 44;
  _actor_variables->Scanmode[0 + 167] = 45;
  _actor_variables->Scanmode[0 + 168] = 36;
  _actor_variables->Scanmode[0 + 169] = 37;
  _actor_variables->Scanmode[0 + 170] = 40;
  _actor_variables->Scanmode[0 + 171] = 41;
  _actor_variables->Scanmode[0 + 172] = 46;
  _actor_variables->Scanmode[0 + 173] = 47;
  _actor_variables->Scanmode[0 + 174] = 48;
  _actor_variables->Scanmode[0 + 175] = 49;
  _actor_variables->Scanmode[0 + 176] = 38;
  _actor_variables->Scanmode[0 + 177] = 39;
  _actor_variables->Scanmode[0 + 178] = 50;
  _actor_variables->Scanmode[0 + 179] = 51;
  _actor_variables->Scanmode[0 + 180] = 56;
  _actor_variables->Scanmode[0 + 181] = 57;
  _actor_variables->Scanmode[0 + 182] = 58;
  _actor_variables->Scanmode[0 + 183] = 59;
  _actor_variables->Scanmode[0 + 184] = 52;
  _actor_variables->Scanmode[0 + 185] = 53;
  _actor_variables->Scanmode[0 + 186] = 54;
  _actor_variables->Scanmode[0 + 187] = 55;
  _actor_variables->Scanmode[0 + 188] = 60;
  _actor_variables->Scanmode[0 + 189] = 61;
  _actor_variables->Scanmode[0 + 190] = 62;
  _actor_variables->Scanmode[0 + 191] = 63;
  k = 0;
  while (k < 128) {
    _actor_variables->buf[1 * k + 0] = 0;
    k ++;
  }
  _actor_variables->count = 1;
  _actor_variables->half = 0;
  fsm_state = 1;
  while (1) {
    switch (fsm_state) {
    case 1: 
    {
    if (AC_PRED_DIR->peek() < 0) {
      libcal_printf("action MPEG4_algo_IS_skip: get from AC_PRED_DIR\n");
      _call_11 = AC_PRED_DIR->get();
      _token_6 = _call_11;
      libcal_printf("action MPEG4_algo_IS_skip: got %i from AC_PRED_DIR\n", _token_6);
      MPEG4_algo_IS_skip(_actor_variables, _token_6);
      fsm_state = 1;
    } else {
      libcal_printf("action MPEG4_algo_IS_start: get from AC_PRED_DIR\n");
      _call_12 = AC_PRED_DIR->get();
      _token_5 = _call_12;
      libcal_printf("action MPEG4_algo_IS_start: got %i from AC_PRED_DIR\n", _token_5);
      MPEG4_algo_IS_start(_actor_variables, _token_5);
      fsm_state = 5;
    }
    break;
    }
    case 2: 
    {
    if (_actor_variables->count == 64) {
      MPEG4_algo_IS_done(_actor_variables);
      fsm_state = 3;
    } else {
      libcal_printf("action MPEG4_algo_IS_read_write: get from QFS_AC\n");
      _call_13 = QFS_AC->get();
      _token_1 = _call_13;
      libcal_printf("action MPEG4_algo_IS_read_write: got %i from QFS_AC\n", _token_1);
      MPEG4_algo_IS_read_write(_actor_variables, _token_1, & _out_1);
      libcal_printf("action MPEG4_algo_IS_read_write: put value %i to PQF_AC\n", _out_1);
      PQF_AC->put(_out_1);
      libcal_printf("action MPEG4_algo_IS_read_write: put to PQF_AC OK\n");
      fsm_state = 2;
    }
    break;
    }
    case 3: 
    {
    if (AC_PRED_DIR->peek() < 0) {
      libcal_printf("action MPEG4_algo_IS_skip: get from AC_PRED_DIR\n");
      _call_14 = AC_PRED_DIR->get();
      _token_3 = _call_14;
      libcal_printf("action MPEG4_algo_IS_skip: got %i from AC_PRED_DIR\n", _token_3);
      MPEG4_algo_IS_skip(_actor_variables, _token_3);
      fsm_state = 4;
    } else {
      libcal_printf("action MPEG4_algo_IS_start: get from AC_PRED_DIR\n");
      _call_15 = AC_PRED_DIR->get();
      _token_2 = _call_15;
      libcal_printf("action MPEG4_algo_IS_start: got %i from AC_PRED_DIR\n", _token_2);
      MPEG4_algo_IS_start(_actor_variables, _token_2);
      fsm_state = 2;
    }
    break;
    }
    case 4: 
    {
    if (_actor_variables->count == 64) {
      MPEG4_algo_IS_done(_actor_variables);
      fsm_state = 1;
    } else {
      if (1) {
        MPEG4_algo_IS_write_only(_actor_variables, & _out_2);
        libcal_printf("action MPEG4_algo_IS_write_only: put value %i to PQF_AC\n",
                      _out_2);
        PQF_AC->put(_out_2);
        libcal_printf("action MPEG4_algo_IS_write_only: put to PQF_AC OK\n");
        fsm_state = 4;
      }
    }
    break;
    }
    case 5: 
    {
    if (_actor_variables->count == 64) {
      MPEG4_algo_IS_done(_actor_variables);
      fsm_state = 3;
    } else {
      libcal_printf("action MPEG4_algo_IS_read_only: get from QFS_AC\n");
      _call_16 = QFS_AC->get();
      _token_4 = _call_16;
      libcal_printf("action MPEG4_algo_IS_read_only: got %i from QFS_AC\n", _token_4);
      MPEG4_algo_IS_read_only(_actor_variables, _token_4);
      fsm_state = 5;
    }
    break;
    }
    }
  }
}
}

}
