/* Generated by CIL v. 1.3.6 */
/* print_CIL_Input is false */

struct MPEG4_mgnt_Address_variables {
   int next_comp ;
   int maxh_in_pixels ;
   int luma_read_ring_start ;
   int write_count ;
   int vop_luma_width ;
   int read_row ;
   int vop_chroma_width ;
   int current_size ;
   int current_base ;
   int vop_height ;
   int next_chroma_x ;
   int next_chroma_y ;
   int half_search_in_pixels ;
   int interp_x ;
   int round ;
   int maxw_in_pixels ;
   int current_h ;
   int current_w ;
   int current_x ;
   int current_y ;
   int vop_width ;
   int next_luma_x ;
   int next_luma_y ;
   int vop_chroma_height ;
   int luma_base ;
   int LAYOUT ;
   int chroma_base ;
   int next_mbx ;
   int next_mby ;
   int vop_luma_height ;
   int current_read_ring_start ;
   int read_count ;
   int read_col ;
   int mvx ;
   int mvy ;
   int chroma_read_ring_start ;
   int current_write_ring_start ;
   int luma_write_ring_start ;
   int chroma_write_ring_start ;
   int chroma_pixel_offset ;
   int luma_pixel_offset ;
   int max_chroma_pixels ;
   int max_luma_pixels ;
   int chroma_buf_size ;
   int luma_buf_size ;
};
void libcal_printf(char const   *format  , ...) ;
// To enable traces, change 1 by 0 in the #if below
#if 1
#define libcal_printf //
#endif
int currentSystemTime(void) ;
int openFile(char *file_name ) ;
void picture_displayImage(void) ;
void picture_setPixel(int x , int y , int r , int g , int b ) ;
int readByte(int fd ) ;
int JFrame(char *title ) ;
int Picture(int width , int height ) ;
void MPEG4_mgnt_Address_cmd_dot_motion(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                       int cmd ) ;
void MPEG4_mgnt_Address_cmd_dot_neither(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                        int cmd , int *halfpel ) ;
void MPEG4_mgnt_Address_cmd_dot_newVop(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                       int cmd ) ;
void MPEG4_mgnt_Address_cmd_dot_noMotion(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                         int cmd ) ;
int MPEG4_mgnt_Address_done(struct MPEG4_mgnt_Address_variables *_actor_variables ) ;
void MPEG4_mgnt_Address_function_advance_block(struct MPEG4_mgnt_Address_variables *_actor_variables ) ;
void MPEG4_mgnt_Address_function_advance_vop(struct MPEG4_mgnt_Address_variables *_actor_variables ) ;
int MPEG4_mgnt_Address_function_generate_read_addr(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                                   int dx , int dy ) ;
int MPEG4_mgnt_Address_function_generate_write_addr(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                                    int dx , int dy ) ;
void MPEG4_mgnt_Address_geth(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                             int h ) ;
void MPEG4_mgnt_Address_getmvx(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                               int x ) ;
void MPEG4_mgnt_Address_getmvy(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                               int y , int *halfpel ) ;
void MPEG4_mgnt_Address_getw(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                             int w ) ;
void MPEG4_mgnt_Address_init(struct MPEG4_mgnt_Address_variables *_actor_variables ) ;
void MPEG4_mgnt_Address_read_addr(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                  int *RA ) ;
void MPEG4_mgnt_Address_write_addr(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                   int *WA ) ;
void MPEG4_mgnt_Address_cmd_dot_motion(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                       int cmd ) 
{ 

  {

}
}
void MPEG4_mgnt_Address_cmd_dot_neither(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                        int cmd , int *halfpel ) 
{ 

  {
  _actor_variables->mvx = 0;
  _actor_variables->mvy = 0;
  _actor_variables->read_count = 0;
  _actor_variables->read_row = 0;
  _actor_variables->read_col = 0;
  _actor_variables->write_count = 0;
  *halfpel = 0;
}
}
void MPEG4_mgnt_Address_cmd_dot_newVop(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                       int cmd ) 
{ 

  {
  _actor_variables->round = (cmd & 32) != 0;
}
}
void MPEG4_mgnt_Address_cmd_dot_noMotion(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                         int cmd ) 
{ 

  {
  _actor_variables->read_count = 81;
  _actor_variables->write_count = 0;
}
}
int MPEG4_mgnt_Address_done(struct MPEG4_mgnt_Address_variables *_actor_variables ) 
{ int res ;

  {

}
}
void MPEG4_mgnt_Address_function_advance_block(struct MPEG4_mgnt_Address_variables *_actor_variables ) 
{ int _if_2 ;
  int _if_3 ;
  int _if_4 ;
  int _if_5 ;
  int _if_6 ;
  int _if_7 ;
  int _if_8 ;
  int _if_9 ;

  {
  if (_actor_variables->LAYOUT == 1) {
    _if_2 = _actor_variables->vop_luma_width;
  } else {
    _if_2 = _actor_variables->vop_chroma_width;
  }
  _actor_variables->current_w = _if_2;
  if (_actor_variables->LAYOUT == 1) {
    _if_3 = _actor_variables->vop_luma_height;
  } else {
    _if_3 = _actor_variables->vop_chroma_height;
  }
  _actor_variables->current_h = _if_3;
  if (_actor_variables->LAYOUT == 1) {
    _if_4 = _actor_variables->max_luma_pixels;
  } else {
    _if_4 = _actor_variables->max_chroma_pixels;
  }
  _actor_variables->current_size = _if_4;
  if (_actor_variables->LAYOUT == 1) {
    _if_5 = _actor_variables->next_luma_x;
  } else {
    _if_5 = _actor_variables->next_chroma_x;
  }
  _actor_variables->current_x = _if_5;
  if (_actor_variables->LAYOUT == 1) {
    _if_6 = _actor_variables->next_luma_y;
  } else {
    _if_6 = _actor_variables->next_chroma_y;
  }
  _actor_variables->current_y = _if_6;
  if (_actor_variables->LAYOUT == 1) {
    _if_7 = _actor_variables->luma_read_ring_start;
  } else {
    _if_7 = _actor_variables->chroma_read_ring_start;
  }
  _actor_variables->current_read_ring_start = _if_7;
  if (_actor_variables->LAYOUT == 1) {
    _if_8 = _actor_variables->luma_write_ring_start;
  } else {
    _if_8 = _actor_variables->chroma_write_ring_start;
  }
  _actor_variables->current_write_ring_start = _if_8;
  if (_actor_variables->LAYOUT == 1) {
    _if_9 = _actor_variables->luma_base;
  } else {
    _if_9 = _actor_variables->chroma_base;
  }
  _actor_variables->current_base = _if_9;
  if (_actor_variables->LAYOUT == 1) {
    (_actor_variables->next_comp) ++;
    if (_actor_variables->next_comp == 1 || _actor_variables->next_comp == 3) {
      _actor_variables->next_luma_x += 8;
    }
    if (_actor_variables->next_comp == 2) {
      _actor_variables->next_luma_x -= 8;
      _actor_variables->next_luma_y += 8;
    }
    if (_actor_variables->next_comp > 3) {
      _actor_variables->next_comp = 0;
      (_actor_variables->next_mbx) ++;
      if (_actor_variables->next_mbx >= _actor_variables->vop_width) {
        _actor_variables->next_mbx = 0;
        _actor_variables->next_luma_x = 0;
        (_actor_variables->next_mby) ++;
        _actor_variables->next_luma_y += 8;
      } else {
        _actor_variables->next_luma_x += 8;
        _actor_variables->next_luma_y -= 8;
      }
    }
  } else {
    (_actor_variables->next_mbx) ++;
    _actor_variables->next_chroma_x += 8;
    if (_actor_variables->next_mbx >= _actor_variables->vop_width) {
      _actor_variables->next_mbx = 0;
      _actor_variables->next_chroma_x = 0;
      (_actor_variables->next_mby) ++;
      _actor_variables->next_chroma_y += 8;
    }
  }
}
}
void MPEG4_mgnt_Address_function_advance_vop(struct MPEG4_mgnt_Address_variables *_actor_variables ) 
{ 

  {
  _actor_variables->vop_luma_width = _actor_variables->vop_width << 4;
  _actor_variables->vop_luma_height = _actor_variables->vop_height << 4;
  _actor_variables->vop_chroma_width = _actor_variables->vop_width << 3;
  _actor_variables->vop_chroma_height = _actor_variables->vop_height << 3;
  _actor_variables->luma_read_ring_start = _actor_variables->luma_write_ring_start;
  _actor_variables->luma_write_ring_start -= _actor_variables->luma_pixel_offset;
  if (_actor_variables->luma_write_ring_start < 0) {
    _actor_variables->luma_write_ring_start += _actor_variables->max_luma_pixels;
  }
  _actor_variables->chroma_read_ring_start = _actor_variables->chroma_write_ring_start;
  _actor_variables->chroma_write_ring_start -= _actor_variables->chroma_pixel_offset;
  if (_actor_variables->chroma_write_ring_start < 0) {
    _actor_variables->chroma_write_ring_start += _actor_variables->max_chroma_pixels;
  }
  _actor_variables->next_mbx = 0;
  _actor_variables->next_mby = 0;
  _actor_variables->next_comp = 0;
  _actor_variables->next_luma_x = 0;
  _actor_variables->next_luma_y = 0;
  _actor_variables->next_chroma_x = 0;
  _actor_variables->next_chroma_y = 0;
}
}
int MPEG4_mgnt_Address_function_generate_read_addr(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                                   int dx , int dy ) 
{ int x ;
  int x_sat ;
  int y ;
  int y_sat ;
  int i ;
  int i_wrap ;
  int res ;
  int _if_11 ;
  int _if_12 ;
  int _if_13 ;
  int _if_14 ;
  int _if_15 ;
  int _if_16 ;

  {
  x = _actor_variables->current_x + dx;
  if (x < 0) {
    _if_12 = 0;
  } else {
    if (x >= _actor_variables->current_w) {
      _if_11 = _actor_variables->current_w - 1;
    } else {
      _if_11 = x;
    }
    _if_12 = _if_11;
  }
  x_sat = _if_12;
  y = _actor_variables->current_y + dy;
  if (y < 0) {
    _if_14 = 0;
  } else {
    if (y >= _actor_variables->current_h) {
      _if_13 = _actor_variables->current_h - 1;
    } else {
      _if_13 = y;
    }
    _if_14 = _if_13;
  }
  y_sat = _if_14;
  i = (_actor_variables->current_read_ring_start + x_sat) + y_sat * _actor_variables->current_w;
  if (i < 0) {
    _if_16 = i + _actor_variables->current_size;
  } else {
    if (i >= _actor_variables->current_size) {
      _if_15 = i - _actor_variables->current_size;
    } else {
      _if_15 = i;
    }
    _if_16 = _if_15;
  }
  i_wrap = _if_16;
  res = _actor_variables->current_base + i_wrap;
  return (res);
}
}
int MPEG4_mgnt_Address_function_generate_write_addr(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                                    int dx , int dy ) 
{ int x ;
  int y ;
  int i ;
  int i_wrap ;
  int res ;
  int _if_9 ;

  {
  x = _actor_variables->current_x + dx;
  y = _actor_variables->current_y + dy;
  i = (_actor_variables->current_write_ring_start + x) + y * _actor_variables->current_w;
  if (i >= _actor_variables->current_size) {
    _if_9 = i - _actor_variables->current_size;
  } else {
    _if_9 = i;
  }
  i_wrap = _if_9;
  res = _actor_variables->current_base + i_wrap;
  return (res);
}
}
void MPEG4_mgnt_Address_geth(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                             int h ) 
{ 

  {
  _actor_variables->vop_height = h;
  MPEG4_mgnt_Address_function_advance_vop(_actor_variables);
}
}
void MPEG4_mgnt_Address_getmvx(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                               int x ) 
{ 

  {
  _actor_variables->interp_x = (x & 1) == 1;
  _actor_variables->mvx = x >> 1;
}
}
void MPEG4_mgnt_Address_getmvy(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                               int y , int *halfpel ) 
{ int interp_y ;
  int _if_5 ;
  int _if_6 ;
  int _if_7 ;

  {
  interp_y = (y & 1) == 1;
  _actor_variables->mvy = y >> 1;
  _actor_variables->read_count = 0;
  _actor_variables->read_row = 0;
  _actor_variables->read_col = 0;
  _actor_variables->write_count = 0;
  if (_actor_variables->interp_x) {
    _if_5 = 4;
  } else {
    _if_5 = 0;
  }
  if (interp_y) {
    _if_6 = 2;
  } else {
    _if_6 = 0;
  }
  if (_actor_variables->round) {
    _if_7 = 1;
  } else {
    _if_7 = 0;
  }
  *halfpel = (_if_5 + _if_6) + _if_7;
}
}
void MPEG4_mgnt_Address_getw(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                             int w ) 
{ 

  {
  _actor_variables->vop_width = w;
}
}
void MPEG4_mgnt_Address_init(struct MPEG4_mgnt_Address_variables *_actor_variables ) 
{ 

  {
  MPEG4_mgnt_Address_function_advance_block(_actor_variables);
}
}
void MPEG4_mgnt_Address_read_addr(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                  int *RA ) 
{ int a ;
  int _call_4 ;

  {
  _call_4 = MPEG4_mgnt_Address_function_generate_read_addr(_actor_variables, _actor_variables->mvx + _actor_variables->read_col,
                                                           _actor_variables->mvy + _actor_variables->read_row);
  a = _call_4;
  (_actor_variables->read_count) ++;
  (_actor_variables->read_col) ++;
  if (_actor_variables->read_col >= 9) {
    _actor_variables->read_col = 0;
    (_actor_variables->read_row) ++;
  }
  *RA = a;
}
}
void MPEG4_mgnt_Address_write_addr(struct MPEG4_mgnt_Address_variables *_actor_variables ,
                                   int *WA ) 
{ int a ;
  int _call_4 ;

  {
  _call_4 = MPEG4_mgnt_Address_function_generate_write_addr(_actor_variables, _actor_variables->write_count & 7,
                                                            _actor_variables->write_count >> 3);
  a = _call_4;
  (_actor_variables->write_count) ++;
  *WA = a;
}
}
