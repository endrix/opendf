<!--
    Targets for working from terminal window:
    build (default) - generates java files and compiles them
    clean           - removes all generated files and class files
    Targets for working from Eclipse:
    gen             - generates java files
    genClean        - removes all generated files and their class files
  -->
<project name="Actors model compiler" default="build" basedir=".">

  <!-- "tools" is the directory where generators and libraries are located. -->
  <property name="tools" value="./tools"/>

  <property name="javacc.home" value="${tools}/javacc-4.0"/>

  <property name="builddir" value="${user.dir}"/>

  <!--   compile sources -->
    <target name="build" depends="gen">
  	  <javac  debug="true" nowarn="true" srcdir=".:${builddir}" destdir="${builddir}/classes/" includes="**/*.java" excludes="tools/**" classpath=".:${tools}/beaver-rt.jar:${tools}/junit.jar"/>
    </target>

<!--   <target name="build" depends="gen"> -->
<!--   </target> -->
  
  <target name="gen" depends="xdf,xlim">
  </target>

  <target name="xlim">
	
	<ant antfile="./xlim/build.xml" target="gen" inheritAll="false">
	  <property name="builddir" value="${builddir}"/>
	</ant>
  </target>

  <target name="xdf">
	<ant antfile="./xdf/build.xml" target="gen" inheritAll="false">
	  <property name="builddir" value="${builddir}"/>
	</ant>
  </target>


  <!-- remove generated source files and .class files -->
  <target name="clean" depends="cleanGen">
    <!-- delete all .class files recursively -->
    <delete>
      <fileset dir="${builddir}" includes="**/*.class" excludes="beaver/*.class"/>
    </delete>
  </target>

  <target name="jar" depends="build">
    <jar destfile="ModelCompiler.jar" basedir="." includes="**/*.class" excludes="test/**">
    </jar>
  </target>

  <!-- remove generated source files and their .class files -->
  <target name="cleanGen">
    <delete dir="${builddir}/xlimAST"/>
    <delete dir="${builddir}/xdfAST"/>
  </target>
</project>

